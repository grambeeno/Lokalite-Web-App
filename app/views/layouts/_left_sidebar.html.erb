<% unless ['/login', '/signup', '/business', '/static', '/my'].any? {|path| fullpath.start_with?(path)} || fullpath == '/' %>
  <%#= search_form %>

  <%
    if params[:controller] == 'directory'
      active_tab = 'directory'
    else
      active_tab = 'events'
    end
  -%>

<nav>
  <%= render :partial => '/shared/search' %>
  <div id="category-tabs">
    <ul class='category-tab-buttons'>
      <li><a href="#event-categories">Events</a></li>
      <li><a href="#places-categories">Places</a></li>
    </ul>

    <div id="event-categories">

      <ul class='categories'>
        <%
          EVENT_CATEGORIES.dup.unshift('Featured', 'Trending').push('All Events').each do |category|
            slug = category.parameterize('_')
            classes = [slug]
            if params[:controller] == 'events' and params[:action] == 'index'
              classes << 'active' if slug == params[:category] or (params[:category].blank? and slug.start_with?('all_'))
            end
        %>
          <li class="<%= classes.join(' ') %>">
            <%
              options = {:origin => params[:origin]}
              options[:view_type] = params[:view_type]
              options[:category]  = slug unless category == 'All Events'
            %>
            <%= link_to(category, events_path(options)) %>
          </li>
        <% end %>
      </ul>
    </div>

    <div id="places-categories">
      <ul class='categories'>
        <%
          # not including Featured for places yet, but might want to add that in sometime
          ORGANIZATION_CATEGORIES.dup.push('All Places').each do |category|
          slug = category.parameterize('_')
          classes = [slug]
          if params[:controller] == 'places' and params[:action] == 'index'
            classes << 'active' if slug == params[:category] or (params[:category].blank? and slug.start_with?('all_'))
          end
        %>
          <li class="<%= classes.join(' ') %>">
            <%
              options = {:origin => params[:origin]}
              options[:category] = slug unless category == 'All Places'
            %>
            <%= link_to(category, places_path(options)) %>
          </li>
        <% end %>
      </ul>
    </div>
  </div>

  <% if false && active_tab == 'events' %>
    <h3>Dates</h3>

    <ul>
      <% ['Today', 'Tomorrow', 'This Week', 'This Weekend', 'This Month', 'This Year'].each do |date|
        active = ((Slug.for(date) == params[:date]) || (date=='Today' && params[:date].blank?))
      %>
        <li>
          <%= link_to(date, events_path(:date => date), :class => (active ? 'active' : '')) %>
        </li>
      <% end %>
    </ul>
  <% end %>
</nav>

<% end %>

